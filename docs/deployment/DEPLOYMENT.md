# üöÄ –†–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ NMservices –Ω–∞ —É–¥–∞–ª—ë–Ω–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ

## üìã –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–µ—Ä–≤–µ—Ä–µ

- **IP –∞–¥—Ä–µ—Å:** `12.34.56.78`
- **SSH –ø–æ—Ä—Ç:** `2251`
- **–î–æ—Å—Ç—É–ø–Ω—ã–µ –ø–æ—Ä—Ç—ã –¥–ª—è —Å–µ—Ä–≤–∏—Å–æ–≤:** `9800-9810` (11 –ø–æ—Ä—Ç–æ–≤)
- **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:** SSH —Å –ø–∞—Ä–æ–ª–µ–º

## üéØ –°—Ç—Ä–∞—Ç–µ–≥–∏—è —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  –£–¥–∞–ª—ë–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä (12.34.56.78)                  ‚îÇ
‚îÇ                                                      ‚îÇ
‚îÇ  SSH Session 1 (—Ç–µ—Ä–º–∏–Ω–∞–ª 1)                        ‚îÇ
‚îÇ  ‚îú‚îÄ –†–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è                       ‚îÇ
‚îÇ  ‚îú‚îÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π                         ‚îÇ
‚îÇ  ‚îî‚îÄ –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞ –Ω–∞ –ø–æ—Ä—Ç—É 9800                   ‚îÇ
‚îÇ                                                      ‚îÇ
‚îÇ  SSH Session 2 (—Ç–µ—Ä–º–∏–Ω–∞–ª 2)                        ‚îÇ
‚îÇ  ‚îú‚îÄ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥–æ–≤                               ‚îÇ
‚îÇ  ‚îú‚îÄ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞                               ‚îÇ
‚îÇ  ‚îî‚îÄ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API                               ‚îÇ
‚îÇ                                                      ‚îÇ
‚îÇ  –†–µ–∑–µ—Ä–≤–Ω—ã–µ –ø–æ—Ä—Ç—ã: 9801-9810                        ‚îÇ
‚îÇ  ‚îî‚îÄ –î–ª—è –±—É–¥—É—â–∏—Ö –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤                      ‚îÇ
‚îÇ                                                      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## üîê –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É

### –®–∞–≥ 1: –ü–µ—Ä–≤–∞—è SSH —Å–µ—Å—Å–∏—è (–æ—Å–Ω–æ–≤–Ω–∞—è)

#### Linux/macOS:
```bash
ssh -p 2251 username@12.34.56.78
```

#### Windows (PowerShell):
```powershell
ssh -p 2251 username@12.34.56.78
```

#### Windows (PuTTY):
```
Host Name: 12.34.56.78
Port: 2251
Connection Type: SSH
```

### –®–∞–≥ 2: –í—Ç–æ—Ä–∞—è SSH —Å–µ—Å—Å–∏—è (–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥)

–û—Ç–∫—Ä–æ–π—Ç–µ **–≤—Ç–æ—Ä–æ–π —Ç–µ—Ä–º–∏–Ω–∞–ª** –∏ –ø–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ:

```bash
# –¢–∞ –∂–µ –∫–æ–º–∞–Ω–¥–∞ –≤–æ –≤—Ç–æ—Ä–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ
ssh -p 2251 username@12.34.56.78
```

**‚úÖ –î–∞, –º–æ–∂–Ω–æ –æ—Ç–∫—Ä—ã—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ SSH —Å–µ—Å—Å–∏–π –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ!**

–≠—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞:
- **–°–µ—Å—Å–∏—è 1** - –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–∏—Å–∞
- **–°–µ—Å—Å–∏—è 2** - –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- **–°–µ—Å—Å–∏—è 3** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥–æ–≤

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ

### –í –ø–µ—Ä–≤–æ–π SSH —Å–µ—Å—Å–∏–∏:

#### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Python
python3 --version  # –î–æ–ª–∂–µ–Ω –±—ã—Ç—å 3.11+

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å git
git --version

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã–µ –ø–æ—Ä—Ç—ã
ss -tuln | grep -E '980[0-9]'
```

#### 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Poetry (–µ—Å–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç)

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Poetry
curl -sSL https://install.python-poetry.org | python3 -

# –î–æ–±–∞–≤–∏—Ç—å –≤ PATH (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
export PATH="$HOME/.local/bin:$PATH"
echo 'export PATH="$HOME/.local/bin:$PATH"' >> ~/.bashrc

# –ü—Ä–æ–≤–µ—Ä–∫–∞
poetry --version
```

#### 3. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

```bash
# –°–æ–∑–¥–∞—Ç—å —Ä–∞–±–æ—á—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
mkdir -p ~/projects
cd ~/projects

# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone https://github.com/imchrm/NMservices.git
cd NMservices

# –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ –Ω—É–∂–Ω—É—é –≤–µ—Ç–∫—É
git checkout main  # –∏–ª–∏ strange-lederberg –ø–æ—Å–ª–µ merge
```

#### 4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

```bash
# –°–æ–∑–¥–∞—Ç—å .env —Ñ–∞–π–ª
cat > .env << 'EOF'
# API Security
API_SECRET_KEY=your_production_secret_key_here_change_this

# Application
HOST=0.0.0.0
PORT=9800
ENVIRONMENT=production
EOF

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
chmod 600 .env
```

**‚ö†Ô∏è –í–ê–ñ–ù–û:** –ó–∞–º–µ–Ω–∏—Ç–µ `your_production_secret_key_here_change_this` –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á!

```bash
# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω–æ–≥–æ –∫–ª—é—á–∞
python3 -c "import secrets; print(secrets.token_urlsafe(32))"
```

#### 5. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
poetry install --no-dev

# –ò–ª–∏ –µ—Å–ª–∏ –Ω—É–∂–Ω—ã dev-–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
poetry install
```

#### 6. –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç
poetry run pytest -v

# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: 6 passed
```

## üöÄ –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ü—Ä—è–º–æ–π –∑–∞–ø—É—Å–∫ (–¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)

–í **–ø–µ—Ä–≤–æ–π SSH —Å–µ—Å—Å–∏–∏**:

```bash
cd ~/projects/NMservices

# –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞
poetry run nms

# –ò–ª–∏ –Ω–∞–ø—Ä—è–º—É—é
poetry run uvicorn nms.main:app --host 0.0.0.0 --port 9800
```

**‚ö†Ô∏è –ß—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥—ë—Ç:**
- ‚úÖ –°–µ—Ä–≤–∏—Å –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –Ω–∞ –ø–æ—Ä—Ç—É 9800
- ‚ö†Ô∏è **–¢–µ—Ä–º–∏–Ω–∞–ª –±—É–¥–µ—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω** - –Ω–µ–ª—å–∑—è –≤—ã–ø–æ–ª–Ω—è—Ç—å –¥—Ä—É–≥–∏–µ –∫–æ–º–∞–Ω–¥—ã
- ‚ö†Ô∏è –ü—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞ —Å–µ—Ä–≤–∏—Å –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è
- ‚úÖ –í—ã —É–≤–∏–¥–∏—Ç–µ –ª–æ–≥–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

**–í–æ –≤—Ç–æ—Ä–æ–π SSH —Å–µ—Å—Å–∏–∏** –º–æ–∂–Ω–æ —Å—Ä–∞–∑—É —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å:

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Å–µ—Ä–≤–∏—Å —Ä–∞–±–æ—Ç–∞–µ—Ç
curl http://localhost:9800/

# –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å API –∫–ª—é—á–æ–º
curl -H "X-API-Key: your_api_key" \
     -H "Content-Type: application/json" \
     -d '{"phone_number": "+998901234567"}' \
     http://localhost:9800/register
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ó–∞–ø—É—Å–∫ –≤ —Ñ–æ–Ω–µ (–¥–ª—è production)

–í **–ø–µ—Ä–≤–æ–π SSH —Å–µ—Å—Å–∏–∏**:

```bash
cd ~/projects/NMservices

# –ó–∞–ø—É—Å–∫ –≤ —Ñ–æ–Ω–µ —Å nohup
nohup poetry run uvicorn nms.main:app \
  --host 0.0.0.0 \
  --port 9800 \
  > ~/nms.log 2>&1 &

# –ó–∞–ø–∏—Å–∞—Ç—å PID
echo $! > ~/nms.pid

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–ø—É—Å–∫
cat ~/nms.pid
ps aux | grep uvicorn
```

**‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –°–µ—Ä–≤–∏—Å —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Ñ–æ–Ω–µ
- –¢–µ—Ä–º–∏–Ω–∞–ª —Å–≤–æ–±–æ–¥–µ–Ω –¥–ª—è –¥—Ä—É–≥–∏—Ö –∫–æ–º–∞–Ω–¥
- –°–µ—Ä–≤–∏—Å –Ω–µ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞
- –õ–æ–≥–∏ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ —Ñ–∞–π–ª

**–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–æ–º:**

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
ps -p $(cat ~/nms.pid)

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
tail -f ~/nms.log

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–µ—Ä–≤–∏—Å
kill $(cat ~/nms.pid)

# –ò–ª–∏ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ
kill -9 $(cat ~/nms.pid)
```

### –í–∞—Ä–∏–∞–Ω—Ç 3: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ screen/tmux (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

#### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ tmux (–µ—Å–ª–∏ –Ω–µ—Ç):

```bash
# Ubuntu/Debian
sudo apt-get install tmux

# CentOS/RHEL
sudo yum install tmux
```

#### –ó–∞–ø—É—Å–∫ –≤ tmux:

–í **–ø–µ—Ä–≤–æ–π SSH —Å–µ—Å—Å–∏–∏**:

```bash
# –°–æ–∑–¥–∞—Ç—å tmux —Å–µ—Å—Å–∏—é
tmux new -s nms

# –í tmux —Å–µ—Å—Å–∏–∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å
cd ~/projects/NMservices
poetry run uvicorn nms.main:app --host 0.0.0.0 --port 9800

# –û—Ç–∫–ª—é—á–∏—Ç—å—Å—è –æ—Ç tmux (—Å–µ—Ä–≤–∏—Å –ø—Ä–æ–¥–æ–ª–∂–∏—Ç —Ä–∞–±–æ—Ç–∞—Ç—å)
# –ù–∞–∂–∞—Ç—å: Ctrl+B, –∑–∞—Ç–µ–º D
```

**–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ tmux:**

```bash
# –°–ø–∏—Å–æ–∫ —Å–µ—Å—Å–∏–π
tmux ls

# –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Å—Å–∏–∏
tmux attach -t nms

# –£–±–∏—Ç—å —Å–µ—Å—Å–∏—é
tmux kill-session -t nms
```

**‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ tmux:**
- –°–µ—Ä–≤–∏—Å —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Ñ–æ–Ω–µ
- –ú–æ–∂–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å—Å—è –∏ –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –æ–±—Ä–∞—Ç–Ω–æ
- –í–∏–¥–Ω—ã –ª–æ–≥–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- –£–¥–æ–±–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

### –í–∞—Ä–∏–∞–Ω—Ç 4: Systemd service (production-ready)

–°–æ–∑–¥–∞—Ç—å systemd service –¥–ª—è –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞.

#### 1. –°–æ–∑–¥–∞—Ç—å service —Ñ–∞–π–ª:

```bash
sudo nano /etc/systemd/system/nms.service
```

```ini
[Unit]
Description=NoMus Services API
After=network.target

[Service]
Type=simple
User=your_username
WorkingDirectory=/home/your_username/projects/NMservices
Environment="PATH=/home/your_username/.local/bin:/usr/local/bin:/usr/bin:/bin"
ExecStart=/home/your_username/.local/bin/poetry run uvicorn nms.main:app --host 0.0.0.0 --port 9800
Restart=always
RestartSec=10

[Install]
WantedBy=multi-user.target
```

**‚ö†Ô∏è –ó–∞–º–µ–Ω–∏—Ç–µ `your_username` –Ω–∞ —Ä–µ–∞–ª—å–Ω–æ–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è!**

#### 2. –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å service:

```bash
# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å systemd
sudo systemctl daemon-reload

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å
sudo systemctl start nms

# –í–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫
sudo systemctl enable nms

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
sudo systemctl status nms

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
sudo journalctl -u nms -f
```

**‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ systemd:**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å–µ—Ä–≤–µ—Ä–∞
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏
- –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å–∏—Å—Ç–µ–º–æ–π –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –í–æ –≤—Ç–æ—Ä–æ–π SSH —Å–µ—Å—Å–∏–∏:

#### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ —Å–µ—Ä–≤–∏—Å–∞

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –ø–æ—Ä—Ç —Å–ª—É—à–∞–µ—Ç—Å—è
ss -tuln | grep 9800

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å—ã
ps aux | grep uvicorn

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç–∫—Ä—ã—Ç—ã–µ —Ñ–∞–π–ª—ã
lsof -i :9800
```

#### 2. –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# Health check
curl http://localhost:9800/

# –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è (–∑–∞–º–µ–Ω–∏—Ç–µ API –∫–ª—é—á!)
curl -X POST \
  -H "X-API-Key: your_api_key" \
  -H "Content-Type: application/json" \
  -d '{"phone_number": "+998901234567"}' \
  http://localhost:9800/register

# –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞
curl -X POST \
  -H "X-API-Key: your_api_key" \
  -H "Content-Type: application/json" \
  -d '{"user_id": 123, "tariff_code": "standard_300"}' \
  http://localhost:9800/create_order
```

#### 3. –£–¥–∞–ª—ë–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (—Å –≤–∞—à–µ–π –º–∞—à–∏–Ω—ã)

–ù–∞ **–ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ** (–Ω–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ):

**‚ö†Ô∏è –í–ê–ñ–ù–û:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ñ–∞–π—Ä–≤–æ–ª–∞! –ü–æ—Ä—Ç 9800 –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ—Ç–∫—Ä—ã—Ç –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π.

```bash
# Linux/macOS
./scripts/test_api.sh \
  --host 12.34.56.78 \
  --port 9800 \
  --key "your_api_key"

# Windows PowerShell
.\scripts\test_api.ps1 `
  -Host "12.34.56.78" `
  -Port 9800 `
  -ApiKey "your_api_key"
```

#### 4. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥–æ–≤

```bash
# –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ nohup
tail -f ~/nms.log

# –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ systemd
sudo journalctl -u nms -f

# –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –æ—à–∏–±–æ–∫
tail -f ~/nms.log | grep ERROR
```

#### 5. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–µ—Å—É—Ä—Å–æ–≤

```bash
# CPU –∏ –ø–∞–º—è—Ç—å
top -p $(pgrep -f uvicorn)

# –ò–ª–∏ htop (–±–æ–ª–µ–µ —É–¥–æ–±–Ω—ã–π)
htop -p $(pgrep -f uvicorn)

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –ø—Ä–æ—Ü–µ—Å—Å—É
ps aux | grep uvicorn
```

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### 1. Firewall –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–µ–∫—É—â–∏–µ –ø—Ä–∞–≤–∏–ª–∞
sudo iptables -L -n

# –û—Ç–∫—Ä—ã—Ç—å –ø–æ—Ä—Ç 9800 (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
sudo iptables -A INPUT -p tcp --dport 9800 -j ACCEPT

# –ò–ª–∏ —Å ufw (Ubuntu)
sudo ufw allow 9800/tcp
sudo ufw status
```

**‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ:** –ü–æ—Ä—Ç—ã 9800-9810 –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –æ—Ç–∫—Ä—ã—Ç—ã –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å –Ω–∏–º!

### 2. –ó–∞—â–∏—Ç–∞ API –∫–ª—é—á–∞

```bash
# –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ .env –Ω–µ –≤ git
cat .gitignore | grep .env

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
ls -la .env  # –î–æ–ª–∂–Ω–æ –±—ã—Ç—å -rw------- (600)
```

### 3. HTTPS/SSL (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è production)

–î–ª—è production —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å nginx –∫–∞–∫ reverse proxy —Å SSL:

```bash
# –°—Ö–µ–º–∞ —Å nginx
Internet ‚Üí nginx:443 (HTTPS) ‚Üí uvicorn:9800 (HTTP)
```

## üö® –ß—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥—ë—Ç –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤?

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ü—Ä—è–º–æ–π –∑–∞–ø—É—Å–∫ (–±–µ–∑ —Ñ–æ–Ω–∞)

```bash
poetry run nms
```

**–ß—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥—ë—Ç:**
1. ‚úÖ –°–µ—Ä–≤–∏—Å –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –Ω–∞ –ø–æ—Ä—Ç—É 9800
2. ‚ö†Ô∏è –¢–µ—Ä–º–∏–Ω–∞–ª –±—É–¥–µ—Ç **–∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω** - –≤—ã —É–≤–∏–¥–∏—Ç–µ –ª–æ–≥–∏
3. ‚ö†Ô∏è –ù–µ–ª—å–∑—è –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å –¥—Ä—É–≥–∏–µ –∫–æ–º–∞–Ω–¥—ã –≤ —ç—Ç–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ
4. ‚úÖ API –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ `http://12.34.56.78:9800` (–µ—Å–ª–∏ –ø–æ—Ä—Ç –æ—Ç–∫—Ä—ã—Ç –≤ —Ñ–∞–π—Ä–≤–æ–ª–µ)
5. ‚ö†Ô∏è –ü—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ SSH —Å–µ—Å—Å–∏–∏ (–∏–ª–∏ Ctrl+C) —Å–µ—Ä–≤–∏—Å **–æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è**
6. ‚úÖ –ú–æ–∂–µ—Ç–µ –æ—Ç–∫—Ä—ã—Ç—å **–≤—Ç–æ—Ä—É—é SSH —Å–µ—Å—Å–∏—é** –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

**–í—ã–≤–æ–¥:**
```
INFO:     Started server process [12345]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:9800 (Press CTRL+C to quit)
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ó–∞–ø—É—Å–∫ –≤ —Ñ–æ–Ω–µ (nohup)

```bash
nohup poetry run nms > ~/nms.log 2>&1 &
```

**–ß—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥—ë—Ç:**
1. ‚úÖ –°–µ—Ä–≤–∏—Å –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –≤ **—Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ**
2. ‚úÖ –¢–µ—Ä–º–∏–Ω–∞–ª **—Å–≤–æ–±–æ–¥–µ–Ω** - –º–æ–∂–µ—Ç–µ –≤—ã–ø–æ–ª–Ω—è—Ç—å –¥—Ä—É–≥–∏–µ –∫–æ–º–∞–Ω–¥—ã
3. ‚úÖ API –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ `http://12.34.56.78:9800`
4. ‚úÖ –ü—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ SSH —Å–µ—Å—Å–∏–∏ —Å–µ—Ä–≤–∏—Å **–ø—Ä–æ–¥–æ–ª–∂–∏—Ç —Ä–∞–±–æ—Ç–∞—Ç—å**
5. ‚úÖ –õ–æ–≥–∏ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ `~/nms.log`
6. ‚úÖ –ú–æ–∂–µ—Ç–µ –æ—Ç–∫—Ä—ã—Ç—å –≤—Ç–æ—Ä—É—é —Å–µ—Å—Å–∏—é –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ tmux

```bash
tmux new -s nms
poetry run nms
# –ù–∞–∂–∞—Ç—å Ctrl+B, –∑–∞—Ç–µ–º D –¥–ª—è –æ—Ç–∫–ª—é—á–µ–Ω–∏—è
```

**–ß—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥—ë—Ç:**
1. ‚úÖ –°–µ—Ä–≤–∏—Å —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ **tmux —Å–µ—Å—Å–∏–∏**
2. ‚úÖ –ú–æ–∂–µ—Ç–µ –æ—Ç–∫–ª—é—á–∏—Ç—å—Å—è –æ—Ç —Å–µ—Å—Å–∏–∏ - —Å–µ—Ä–≤–∏—Å –ø—Ä–æ–¥–æ–ª–∂–∏—Ç —Ä–∞–±–æ—Ç–∞—Ç—å
3. ‚úÖ –ú–æ–∂–µ—Ç–µ –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –æ–±—Ä–∞—Ç–Ω–æ: `tmux attach -t nms`
4. ‚úÖ –í–∏–¥–Ω—ã –ª–æ–≥–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
5. ‚úÖ –ü—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ SSH —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å–µ—Ä–≤–∏—Å —Ä–∞–±–æ—Ç–∞–µ—Ç
6. ‚úÖ –ú–æ–∂–µ—Ç–µ –æ—Ç–∫—Ä—ã—Ç—å –≤—Ç–æ—Ä—É—é SSH —Å–µ—Å—Å–∏—é

## üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞

### 1. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–µ—Ä–≤–∏—Å

```bash
# –ï—Å–ª–∏ nohup
kill $(cat ~/nms.pid)

# –ï—Å–ª–∏ systemd
sudo systemctl stop nms

# –ï—Å–ª–∏ tmux
tmux kill-session -t nms
```

### 2. –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–¥

```bash
cd ~/projects/NMservices
git pull origin main
poetry install
```

### 3. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–Ω–æ–≤–∞

```bash
# –í—ã–±–µ—Ä–∏—Ç–µ –æ–¥–∏–Ω –∏–∑ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –≤—ã—à–µ
```

## üìã –ß–µ–∫-–ª–∏—Å—Ç —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è

### –ü–µ—Ä–µ–¥ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ–º:
- [ ] Python 3.11+ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- [ ] Poetry —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- [ ] Git —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- [ ] –ü–æ—Ä—Ç 9800 –æ—Ç–∫—Ä—ã—Ç –≤ —Ñ–∞–π—Ä–≤–æ–ª–µ
- [ ] SSH –¥–æ—Å—Ç—É–ø —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –ø–æ—Ä—Ç—É 2251

### –í–æ –≤—Ä–µ–º—è —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è:
- [ ] –ü—Ä–æ–µ–∫—Ç —Å–∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω
- [ ] –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã (`poetry install`)
- [ ] `.env` —Ñ–∞–π–ª —Å–æ–∑–¥–∞–Ω —Å —Å–µ–∫—Ä–µ—Ç–Ω—ã–º –∫–ª—é—á–æ–º
- [ ] –¢–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç (`poetry run pytest`)
- [ ] –°–µ—Ä–≤–∏—Å –∑–∞–ø—É—â–µ–Ω –Ω–∞ –ø–æ—Ä—Ç—É 9800

### –ü–æ—Å–ª–µ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è:
- [ ] Health check —Ä–∞–±–æ—Ç–∞–µ—Ç (`curl http://localhost:9800/`)
- [ ] API endpoints –æ—Ç–≤–µ—á–∞—é—Ç
- [ ] –¢–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç —É–¥–∞–ª—ë–Ω–Ω–æ (`./scripts/test_api.sh`)
- [ ] –õ–æ–≥–∏ –º–æ–Ω–∏—Ç–æ—Ä—è—Ç—Å—è
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫ (systemd –∏–ª–∏ –¥—Ä—É–≥–æ–π —Å–ø–æ—Å–æ–±)

## üéØ –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è

### –î–ª—è –ø–µ—Ä–≤–æ–≥–æ –¥–µ–ø–ª–æ—è (—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ):
1. **–°–µ—Å—Å–∏—è 1:** –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å `tmux` - –≤–∏–¥–Ω—ã –ª–æ–≥–∏, –º–æ–∂–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å—Å—è
2. **–°–µ—Å—Å–∏—è 2:** –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç
4. –ï—Å–ª–∏ –≤—Å—ë –û–ö - –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å systemd –¥–ª—è production

### –î–ª—è production:
1. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å **systemd service** –¥–ª—è –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞
2. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å **nginx** –∫–∞–∫ reverse proxy —Å SSL
3. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å **–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** (–ª–æ–≥–∏, –º–µ—Ç—Ä–∏–∫–∏)
4. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å **—Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ**

## üìû Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: –ü–æ—Ä—Ç —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è

```bash
# –ù–∞–π—Ç–∏ –ø—Ä–æ—Ü–µ—Å—Å –Ω–∞ –ø–æ—Ä—Ç—É
lsof -i :9800

# –£–±–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å
kill -9 $(lsof -t -i:9800)
```

### –ü—Ä–æ–±–ª–µ–º–∞: Connection refused –∏–∑–≤–Ω–µ

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Å–µ—Ä–≤–∏—Å —Å–ª—É—à–∞–µ—Ç 0.0.0.0
ss -tuln | grep 9800

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–∞–π—Ä–≤–æ–ª
sudo iptables -L -n | grep 9800

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å —Å–µ—Ä–≤–µ—Ä–∞
curl http://localhost:9800/
```

### –ü—Ä–æ–±–ª–µ–º–∞: –°–µ—Ä–≤–∏—Å –ø–∞–¥–∞–µ—Ç

```bash
# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏
tail -100 ~/nms.log

# –ò–ª–∏ systemd
sudo journalctl -u nms -n 100
```

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è:

1. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:** –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Å–∏—Å—Ç–µ–º—É –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ (Prometheus, Grafana)
2. **CI/CD:** –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–µ–ø–ª–æ–π —á–µ—Ä–µ–∑ GitHub Actions
3. **–†–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏:** –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –±—ç–∫–∞–ø—ã –ë–î –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π
4. **–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ—Ä—Ç—ã (9801-9810) –¥–ª—è –¥—Ä—É–≥–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
5. **Load Balancer:** –ù–∞—Å—Ç—Ä–æ–∏—Ç—å nginx –¥–ª—è –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏ –Ω–∞–≥—Ä—É–∑–∫–∏

---

**–°–æ–∑–¥–∞–Ω–æ:** 2025-12-04
**–°–µ—Ä–≤–µ—Ä:** 12.34.56.78:2251
**–ü–æ—Ä—Ç—ã:** 9800-9810
